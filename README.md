# Zoom 강의 출석 자동화 v2.0 🎓

듀얼 모니터 환경에서 서브모니터의 Zoom 화면을 실시간으로 모니터링하여 참가자 얼굴을 감지하고 자동으로 출석을 체크하는 데스크톱 애플리케이션입니다.

## 🎯 주요 기능

### 🖥️ 듀얼 모니터 지원
- **서브모니터 자동감지**: Zoom이 실행 중인 모니터 자동 감지
- **실시간 화면 캡쳐**: 서브모니터 전체 화면 실시간 모니터링
- **모니터 선택**: 수동으로 원하는 모니터 선택 가능

### 👤 지능형 얼굴 감지 (메모리 최적화)
- **MTCNN 딥러닝**: 정면 + 측면 얼굴 모두 인식
- **메모리 효율 설계**: 필요 시에만 모델 로드 (73% 메모리 절약)
- **스마트 스케줄링**: 35~50분에만 1분마다 15초간 활성화
- **참가자 박스 인식**: Zoom 개별 참가자 창 자동 감지
- **실시간 시각화**: 얼굴 감지 시 초록색, 미감지 시 빨간색 표시
- **참가자 수 카운팅**: 실시간 참가자 수 및 얼굴 감지 현황

### ⏰ 스마트 스케줄링
- **자동 교시 관리**: 1~8교시 자동 스케줄링 (점심시간 제외)
- **캡쳐 타이밍**: 각 교시 35~45분에 자동 실행
- **선명도 기반 선별**: 가장 선명한 상위 10장만 저장

### 🔔 알림 시스템
- **교시별 알림**: 교시 시작, 캡쳐 시작/종료 알림
- **실시간 상태**: 얼굴 감지 상태 즉시 알림
- **시스템 트레이**: 백그라운드 실행 지원

### 📊 로그 및 기록
- **CSV 로그**: 상세한 출석 기록 자동 저장
- **Excel 내보내기**: 분석용 Excel 파일 생성
- **이미지 저장**: 고화질 증거 이미지 자동 저장

## 📅 교시 시간표

| 교시 | 시간 | 캡쳐 시간 |
|------|------|-----------|
| 1교시 | 09:30-10:20 | 10:05-10:15 |
| 2교시 | 10:30-11:20 | 11:05-11:15 |
| 3교시 | 11:30-12:20 | 12:05-12:15 |
| **점심시간** | 12:30-14:30 | (캡쳐 X) |
| 4교시 | 14:30-15:20 | 15:05-15:15 |
| 5교시 | 15:30-16:20 | 16:05-16:15 |
| 6교시 | 16:30-17:20 | 17:05-17:15 |
| 7교시 | 17:30-18:20 | 18:05-18:15 |
| 8교시 | 18:30-19:20 | 19:05-19:15 |

## 🚀 설치 및 실행

### 📦 방법 1: GitHub에서 다운로드 (권장) ⭐⭐⭐⭐⭐

**일반 사용자용 - Python 설치 불필요, 바로 실행**

1. **GitHub 릴리즈에서 다운로드**
   ```
   https://github.com/USERNAME/zoom-attendance-automation/releases
   ```

2. **바로 실행**
   ```bash
   # Windows
   ZoomAttendance.exe 더블클릭
   ```

3. **자동 업데이트**
   - 새 버전이 자동으로 GitHub에 게시됨
   - 최신 릴리즈에서 다운로드

### 🛠️ 방법 2: 소스코드에서 개발

**개발자용 - 코드 수정 및 기여**

1. **저장소 클론**
   ```bash
   git clone https://github.com/USERNAME/zoom-attendance-automation.git
   cd zoom-attendance-automation
   ```

2. **개발 환경 설정**
   ```bash
   # 가상환경 생성
   python3 -m venv venv
   source venv/bin/activate  # Mac/Linux
   # venv\Scripts\activate   # Windows

   # 의존성 설치
   pip install -r requirements.txt
   ```

3. **개발 모드 실행**
   ```bash
   # GUI 버전
   python desktop_app.py

   # 콘솔 버전  
   python main.py --test
   ```

### 🏗️ 방법 3: 자동 빌드 시스템

**기여자용 - GitHub Actions 자동 빌드**

1. **포크 및 수정**
   ```bash
   # GitHub에서 Fork
   # 코드 수정 후 커밋
   git add .
   git commit -m "기능 개선"
   git push origin main
   ```

2. **자동 빌드**
   - GitHub Actions가 자동으로 Windows용 .exe 생성
   - Pull Request로 기여 가능

## 📁 프로젝트 구조

```
faecproject/
├── main.py                 # 메인 프로그램
├── face_detector.py        # 얼굴 감지 모듈
├── screen_capture.py       # 화면 캡쳐 모듈
├── scheduler.py           # 스케줄링 시스템
├── logger.py              # 로그 기록 시스템
├── requirements.txt       # 필요한 패키지 목록
├── setup_env.sh          # 가상환경 설정 스크립트
├── README.md             # 프로젝트 설명서
├── captures/             # 캡쳐된 이미지 저장 폴더
├── attendance_log.csv    # 출석 기록 로그
└── zoom_attendance.log   # 시스템 로그
```

## 📸 캡쳐된 파일 형식

- **파일명**: `YYYYMMDD_{교시}_n.png`
- **예시**: `20241001_1교시_1.png`, `20241001_1교시_2.png`
- **저장 위치**: `captures/` 폴더
- **최대 개수**: 교시당 10장

## 📊 로그 기록 형식

`attendance_log.csv` 파일에 다음 정보가 기록됩니다:

| 컬럼 | 설명 |
|------|------|
| date | 날짜 (YYYY-MM-DD) |
| class_period | 교시 번호 |
| capture_count | 저장된 이미지 개수 |
| file_names | 저장된 파일명 (세미콜론으로 구분) |
| timestamp | 기록 시각 |
| status | 상태 (success/failed) |

## 🔧 설정 옵션

### 얼굴 감지 설정
- **최소 얼굴 크기**: 30픽셀 (기본값)
- **신뢰도 임계값**: 0.8 (기본값)
- **감지 모델**: MTCNN

### 캡쳐 설정
- **모니터**: 1번 모니터 (기본값)
- **최대 후보 수**: 10장
- **선명도 기준**: Laplacian 분산

## 🛠️ 문제 해결

### 1. 패키지 설치 오류

```bash
# TensorFlow 관련 오류 시
pip install tensorflow==2.13.0

# OpenCV 오류 시
pip install opencv-python-headless
```

### 2. 화면 캡쳐 권한 오류 (macOS)

1. 시스템 환경설정 > 보안 및 개인정보 보호
2. 개인정보 보호 > 화면 기록
3. 터미널 또는 Python 앱 권한 허용

### 3. 얼굴 감지 정확도 개선

```python
# face_detector.py에서 신뢰도 임계값 조정
has_faces = detector.has_faces(image, confidence_threshold=0.7)  # 더 민감하게
```

## 📈 확장 아이디어

### 1. 실시간 모니터링 웹 인터페이스
- Flask/Django를 사용한 웹 대시보드
- 실시간 캡쳐 상태 및 통계 확인

### 2. 고급 얼굴 인식
- 개별 학생 식별 기능
- 출석 통계 및 분석

### 3. 클라우드 저장
- AWS S3, Google Drive 연동
- 자동 백업 기능

### 4. 알림 시스템
- 이메일/SMS 알림
- Slack, Discord 연동

### 5. 데이터 분석
- 출석률 분석 대시보드
- 시간대별 참여도 분석

## 🔐 보안 고려사항

- 캡쳐된 이미지는 로컬에만 저장됩니다
- 개인정보 보호를 위해 정기적인 로그 정리 기능 제공
- 얼굴 데이터는 감지 목적으로만 사용되며 저장되지 않습니다

## 📄 라이선스

이 프로젝트는 교육 목적으로 제작되었습니다. 사용 시 개인정보 보호 및 관련 법규를 준수해야 합니다.

## 🤝 기여

버그 리포트나 기능 제안은 Issues를 통해 알려주세요.

---

**주의**: 이 프로그램을 사용하기 전에 해당 교육기관의 정책과 개인정보 보호 규정을 확인하시기 바랍니다.